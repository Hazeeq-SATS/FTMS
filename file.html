User
<!DOCTYPE html>
<html>
<head>
    <title>Bluetooth Device Connection Example</title>
    <style>
        /* Initially hide the video element */
        #cameraPreview {
            display: none;
            width: 320px;
            height: 240px;
        }
    </style>
</head>
<body>
    <button id="connectButton">Connect to Bluetooth Device</button>
    <button id="captureButton">Capture Temperature and Photo</button>
    <div id="deviceInfo"></div>

    <button id="scanButton">Scan NFC</button> <!-- NFC Scan Button -->
    <div id="nfcContent"></div>
    
    <div id="temperatureValue"></div>
   
    <div id="temperatureValue"></div>
    <video id="cameraPreview" autoplay></video>
    <img id="capturedPhoto" src="" alt="Captured photo" width="320" height="240" style="display:none;">

    <script>
        let globalCharacteristic;
        let stream = null; // To hold the stream globally

        document.getElementById('connectButton').addEventListener('click', function() {
            navigator.bluetooth.requestDevice({
                filters: [{ name: '21057150 RayTemp Blue' }],
                optionalServices: ['45544942-4c55-4554-4845-524db87ad700']
            })
            .then(device => {
                console.log('Device selected:', device.name);
                document.getElementById('deviceInfo').innerText = `Connected to device: ${device.name}`;
                return device.gatt.connect();
            })
            .then(server => {
                return server.getPrimaryService('45544942-4c55-4554-4845-524db87ad700');
            })
            .then(service => {
                return service.getCharacteristic('45544942-4c55-4554-4845-524db87ad701');
            })
            .then(characteristic => {
                globalCharacteristic = characteristic; // Save for later use
                console.log('Ready to receive temperature notifications');
                // Start the video stream and show the video element when Bluetooth is connected
                navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
                    .then(mediaStream => {
                        stream = mediaStream;
                        const video = document.getElementById('cameraPreview');
                        video.srcObject = stream;
                        video.style.display = 'block';
                    })
                    .catch(error => console.error('Error accessing the camera', error));
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('deviceInfo').innerText = `Connection error: ${error}`;
            });
        });

        document.getElementById('captureButton').addEventListener('click', function() {
            if (globalCharacteristic) {
                globalCharacteristic.readValue().then(value => {
                    const temperature = value.getFloat32(0, true);
                    document.getElementById('temperatureValue').innerText = `Temperature: ${temperature}Â°C`;
                    capturePhoto();
                });
            }
        });

        function capturePhoto() {
            const video = document.getElementById('cameraPreview');
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);

            // Convert canvas to an image and display it
            const img = document.getElementById('capturedPhoto');
            img.src = canvas.toDataURL('image/png');
            img.style.display = 'block';

            // Hide the video element and stop the video stream
            video.style.display = 'none';
            if (stream) {
                let tracks = stream.getTracks();
                tracks.forEach(track => track.stop());
            }
        }

 // NFC Scan Button Logic
        document.getElementById('scanButton').addEventListener("click", async () => {
            if ('NDEFReader' in window) {
                try {
                    const ndef = new NDEFReader();
                    await ndef.scan();
                    console.log("> Scan started");

                    ndef.addEventListener("readingerror", () => {
                        console.error("Argh! Cannot read data from the NFC tag. Try another one?");
                    });

                    ndef.addEventListener("reading", ({ message, serialNumber }) => {
                        console.log(`> Serial Number: ${serialNumber}`);
                        console.log(`> Records: (${message.records.length})`);
                        // Display the NFC data or handle as needed
                    });
                } catch (error) {
                    console.error("Argh! " + error);
                }
            } else {
                console.error("Web NFC is not supported.");
            }
        });

    </script>
</body>
</html>
